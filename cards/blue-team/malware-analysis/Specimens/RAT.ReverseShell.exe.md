---
tags:
  - specimen
aliases: 
date-created: 2024-05-24
dg-publish:
---
[[Malware Analysis]]

Floss output:

```
@cmd.exe /c
```

PEstudio output:

![[Pasted image 20240524130602.png]]

## Initial Detonation 
---

![[Pasted image 20240524131620.png]]

- The URL is not hard coded and it is a type A record.
- Pretending to be **aaaaa...kadusus.local** server using the `host` file.

```
vim C:\Windows\System32\drivers\etc\hosts
```

![[Pasted image 20240524132321.png]]
### Second Detonation 
---
But before that we don't know what port does the malware is communicating since Wireshark does not include the port when it is attempting a DNS query. 

Solution `Procmon` and `inetsim` should be turned off:

Potential Callout to specified DNS record on HTTPs port (443)

![[Pasted image 20240524133932.png]]

Then setting up a netcat server with (443):

![[Pasted image 20240524134337.png]]

Testing a command:

![[Pasted image 20240524134441.png]]

A reverse shell.

Checking the process tree of malware in `procmon`:

![[Pasted image 20240524143758.png]]


It is also a good idea to filter using PID of the malware as opposed to the process name.

## Conclusion
---

